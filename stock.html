<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Gestion Stock & Dépôts — SuperMarket Pro</title>
    <meta name="description" content="Gestion complète du stock, dépôts, mouvements et alertes - SuperMarket Pro">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/style_stock.css" />
    <link rel="icon" href="assets/img/favicon.ico" type="image/x-icon" />
</head>

<body>
    <div class="app">
        <aside class="sidebar" aria-label="Navigation principale">
            <div class="brand">
                <div class="logo">SP</div>
                <div>
                    <div style="font-weight:700">SuperMarket Pro</div>
                    <div style="font-size:12px;color:var(--muted)">Stock & Dépôts</div>
                </div>
            </div>

            <nav>
                <a href="acceuil.html" class="menu-item"><i class="fas fa-home"></i> Tableau de Bord</a>
                <a href="pos.html" class="menu-item"><i class="fas fa-cash-register"></i> Vente / Caisse</a>
                <a href="stock.html" class="menu-item active"><i class="fas fa-box"></i> Gestion Stock</a>
            </nav>

            <div class="small">© <span id="year"></span> SuperMarket Pro</div>
        </aside>

        <main class="main" role="main">
            <div class="topbar">
                <h1><i class="fas fa-warehouse"></i> Gestion du Stock & Dépôts</h1>
                <div class="controls">
                    <button class="btn success" id="btn-new-product"><i class="fas fa-plus"></i> Nouveau
                        produit</button>
                    <button class="btn" id="btn-add-stock"><i class="fas fa-arrow-up"></i> Entrée stock</button>
                    <button class="btn warning" id="btn-inventory"><i class="fas fa-sync"></i> Inventaire</button>
                    <button class="btn secondary" id="btn-export"><i class="fas fa-file-export"></i> Export</button>
                </div>
            </div>

            <!-- STATS -->
            <div class="stats">
                <div class="stat-card" style="border-left-color:var(--accent)">
                    <h4>Total Produits</h4>
                    <div class="value" id="stat-total">0</div>
                </div>
                <div class="stat-card" style="border-left-color:var(--accent-2)">
                    <h4>Valeur Stock</h4>
                    <div class="value" id="stat-value">0.00 €</div>
                </div>
                <div class="stat-card" style="border-left-color:var(--warning)">
                    <h4>Stock Bas</h4>
                    <div class="value" id="stat-low">0</div>
                </div>
                <div class="stat-card" style="border-left-color:var(--danger)">
                    <h4>Ruptures</h4>
                    <div class="value" id="stat-critical">0</div>
                </div>
            </div>

            <!-- TABS -->
            <div class="tabs" role="tablist">
                <button class="tab active" data-tab="products"><i class="fas fa-list"></i> Catalogue</button>
                <button class="tab" data-tab="movements"><i class="fas fa-arrows-alt"></i> Mouvements</button>
                <button class="tab" data-tab="depots"><i class="fas fa-map-marker-alt"></i> Dépôts</button>
                <button class="tab" data-tab="alerts"><i class="fas fa-bell"></i> Alertes</button>
                <button class="tab" data-tab="history"><i class="fas fa-history"></i> Historique</button>
            </div>

            <!-- TAB: PRODUCTS -->
            <section id="tab-products" class="panel" role="tabpanel" aria-labelledby="tab-products">
                <div class="filters">
                    <input id="search" class="input" type="search"
                        placeholder="Rechercher produit, ref, catégorie..." />
                    <select id="filter-state" class="input" style="width:140px">
                        <option value="">Tous les États</option>
                        <option value="ok">En stock</option>
                        <option value="low">Stock Bas</option>
                        <option value="critical">Rupture</option>
                    </select>
                    <select id="filter-depot" class="input" style="width:140px">
                        <option value="">Tous les Dépôts</option>
                        <option value="principal">Principal</option>
                        <option value="reserve">Réserve</option>
                        <option value="vitrine">Vitrine</option>
                    </select>
                </div>

                <table aria-label="Catalogue produits">
                    <thead>
                        <tr>
                            <th>Réf / Code</th>
                            <th>Désignation</th>
                            <th>Catégorie</th>
                            <th>Prix A.</th>
                            <th>Prix V.</th>
                            <th style="text-align:center">Dépôt Prin.</th>
                            <th style="text-align:center">Réserve</th>
                            <th style="text-align:center">Vitrine</th>
                            <th>État</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="productsTable"></tbody>
                </table>
            </section>

            <!-- TAB: MOVEMENTS -->
            <section id="tab-movements" class="panel" role="tabpanel" aria-labelledby="tab-movements"
                style="display:none">
                <div class="panel-head">
                    <h3>Mouvements de Stock</h3>
                    <button class="btn" id="btn-new-movement"><i class="fas fa-plus"></i> Nouveau</button>
                </div>

                <table aria-label="Mouvements de stock">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Produit</th>
                            <th>Quantité</th>
                            <th>De / Vers</th>
                            <th>Ref Mouvement</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody id="movementsTable"></tbody>
                </table>
            </section>

            <!-- TAB: DEPOTS -->
            <section id="tab-depots" class="panel" role="tabpanel" aria-labelledby="tab-depots" style="display:none">
                <div class="panel-head">
                    <h3>Gestion des Dépôts</h3>
                    <button class="btn" id="btn-new-depot"><i class="fas fa-plus"></i> Nouveau dépôt</button>
                </div>

                <table aria-label="Liste des dépôts">
                    <thead>
                        <tr>
                            <th>Nom</th>
                            <th>Localisation</th>
                            <th>Type</th>
                            <th>Capacité</th>
                            <th>Articles</th>
                            <th>Valeur</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="depotsTable"></tbody>
                </table>
            </section>

            <!-- TAB: ALERTS -->
            <section id="tab-alerts" class="panel" role="tabpanel" aria-labelledby="tab-alerts" style="display:none">
                <h3>Alertes & Notifications</h3>

                <div id="alertsList" style="display:flex;flex-direction:column;gap:10px"></div>
            </section>

            <!-- TAB: HISTORY -->
            <section id="tab-history" class="panel" role="tabpanel" aria-labelledby="tab-history" style="display:none">
                <div class="filters">
                    <input id="history-search" class="input" type="search" placeholder="Rechercher..." />
                    <input id="history-date-from" type="date" class="input" />
                    <input id="history-date-to" type="date" class="input" />
                    <button class="btn secondary" id="btn-filter-history">Filtrer</button>
                </div>

                <table aria-label="Historique complet">
                    <thead>
                        <tr>
                            <th>Date/Heure</th>
                            <th>Type</th>
                            <th>Détails</th>
                            <th>Utilisateur</th>
                            <th>Remarques</th>
                        </tr>
                    </thead>
                    <tbody id="historyTable"></tbody>
                </table>
            </section>
        </main>
    </div>

    <!-- MODALS -->
    <!-- Modal: Nouveau Produit -->
    <div class="modal" id="modalNewProduct">
        <div class="modal-box">
            <div class="modal-header">
                <h3>Ajouter un Produit</h3>
                <button class="modal-close" data-close="modalNewProduct">&times;</button>
            </div>
            <form id="formNewProduct">
                <div class="form-row full">
                    <div class="form-label">Réf / Code-barre</div>
                    <input name="reference"  id="np-code" class="input" placeholder="Code-barre ou référence unique" required/>
                </div>

                <div class="form-row">
                    <div>
                        <div class="form-label">Désignation</div>
                        <input name="nom_produit" id="np-name" class="input" placeholder="Nom produit" required/>
                    </div>
                    <div>
                        <div class="form-label">Catégorie</div>
                        <select id="np-category" class="input" name="categorie">
                            <option value="">-- Sélectionner --</option>
                            <option value="Alimentaire">Alimentaire</option>
                            <option value="Boisson">Boisson</option>
                            <option value="Hygiène">Hygiène</option>
                            <option value="Autre">Autre</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div>
                        <div class="form-label">Prix Achat</div>
                        <input name="Prix_Achat" id="np-buy" class="input" type="number" placeholder="0.00" step="0.01" required/>
                    </div>
                    <div>
                        <div class="form-label">Prix Vente</div>
                        <input name="Prix_Vente" id="np-sale" class="input" type="number" placeholder="0.00" step="0.01" required/>
                    </div>
                </div>

                <div class="form-row">
                    <div>
                        <div class="form-label">Seuil Alerte</div>
                        <input id="np-alert" name="Seuil_Alerte" class="input" type="number" placeholder="Quantité mini" step="1" value="5" />
                    </div>
                    <div>
                        <div class="form-label">Stock Initial</div>
                        <input id="np-initial" name="Stock_Initial" class="input" type="number" placeholder="0" step="1" />
                    </div>
                </div>

                <div style="display:flex;gap:8px;margin-top:16px">
                    <button class="btn" id="np-save">Enregistrer</button>
                    <button class="btn secondary" data-close="modalNewProduct">Annuler</button>
                </div>
                </form>
        </div>
    </div>

    <!-- Modal: Entrée Stock -->
    <div class="modal" id="modalAddStock">
        <div class="modal-box">
            <div class="modal-header">
                <h3><i class="fas fa-arrow-up"></i> Entrée de Stock</h3>
                <button class="modal-close" data-close="modalAddStock">&times;</button>
            </div>

            <form id="formAddStock" >
                <!-- Sélection du produit -->
                <div class="form-row full">
                    <div class="form-label">Produit <span class="required">*</span></div>
                    <select id="as-product-id" class="input" name="produit" required>
                        <option value="">-- Sélectionner un produit --</option>
                    </select>
                </div>

                <!-- Ligne 2: Dépôt et Quantité -->
                <div class="form-row">
                    <div>
                        <div class="form-label">Dépôt destination <span class="required">*</span></div>
                        <select id="as-depot" class="input" required>
                            <option value="">-- Sélectionner --</option>
                            <option value="principal">Principal</option>
                            <option value="reserve">Réserve</option>
                            <option value="vitrine">Vitrine</option>
                        </select>
                    </div>
                    <div>
                        <div class="form-label">Quantité <span class="required">*</span></div>
                        <input id="as-qty" class="input" type="number" placeholder="0" step="1" min="1" required />
                    </div>
                </div>

                <!-- Ligne 3: Date et Référence -->
                <div class="form-row">
                    <div>
                        <div class="form-label">Date d'entrée <span class="required">*</span></div>
                        <input id="as-date" class="input" type="date" required />
                    </div>
                    <div>
                        <div class="form-label">Numéro de Bon <span class="required">*</span></div>
                        <input id="as-ref" class="input" placeholder="Bon de commande, facture..." required />
                    </div>
                </div>

                <!-- Ligne 4: Notes -->
                <div class="form-row full">
                    <div class="form-label">Notes / Observations</div>
                    <textarea id="as-notes" class="input" placeholder="Remarques, problèmes détectés, conditions..." style="min-height:80px;resize:vertical"></textarea>
                </div>

                <!-- Ligne 5: Informations du produit (affichage) -->
                <div id="as-product-info" style="display:none;background:#f5f5f5;border-radius:6px;padding:12px;margin:12px 0;">
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;font-size:14px;">
                        <div>
                            <span style="color:#666">Prix Achat:</span>
                            <div style="font-weight:600;font-size:16px;color:var(--accent)" id="as-buy-price">0.00 €</div>
                        </div>
                        <div>
                            <span style="color:#666">Stock Actuel:</span>
                            <div style="font-weight:600;font-size:16px;color:var(--accent-2)" id="as-current-stock">0</div>
                        </div>
                    </div>
                </div>

                <!-- Boutons d'action -->
                <div style="display:flex;gap:8px;margin-top:20px;justify-content:flex-end">
                    <button type="reset" class="btn secondary">
                        <i class="fas fa-redo"></i> Réinitialiser
                    </button>
                    <button type="button" class="btn secondary" data-close="modalAddStock">
                        <i class="fas fa-times"></i> Annuler
                    </button>
                    <button type="submit" class="btn success">
                        <i class="fas fa-check"></i> Enregistrer Entrée
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Nouveau Dépôt -->
    <div class="modal" id="modalNewDepot">
        <div class="modal-box">
            <div class="modal-header">
                <h3>Nouveau Dépôt</h3>
                <button class="modal-close" data-close="modalNewDepot">&times;</button>
            </div>

            <div class="form-row">
                <div>
                    <div class="form-label">Nom</div>
                    <input id="nd-name" class="input" placeholder="Ex: Réserve" />
                </div>
                <div>
                    <div class="form-label">Type</div>
                    <select id="nd-type" class="input">
                        <option value="principal">Principal</option>
                        <option value="reserve">Réserve</option>
                        <option value="vitrine">Vitrine</option>
                        <option value="autre">Autre</option>
                    </select>
                </div>
            </div>

            <div class="form-row full">
                <div class="form-label">Localisation</div>
                <input id="nd-location" class="input" placeholder="Adresse / Zone" />
            </div>

            <div class="form-row">
                <div>
                    <div class="form-label">Capacité (m³)</div>
                    <input id="nd-capacity" class="input" type="number" placeholder="0" step="0.1" />
                </div>
                <div>
                    <div class="form-label">Responsable</div>
                    <input id="nd-manager" class="input" placeholder="Nom" />
                </div>
            </div>

            <div style="display:flex;gap:8px;margin-top:16px">
                <button class="btn" id="nd-save">Créer Dépôt</button>
                <button class="btn secondary" data-close="modalNewDepot">Annuler</button>
            </div>
        </div>
    </div>

    <script src="assets/js/script_stock.js"></script>

    </script>
</body>

</html>