<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trésorerie - SuperMarket Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="assets/css/tresoreri.css">
</head>
<body>
    <div class="app">
        <aside class="sidebar" aria-label="Navigation principale">
            <div class="brand">
                <div class="logo">SP</div>
                <div>
                    <div style="font-weight:700">SuperMarket Pro</div>
                    <div style="font-size:12px;color:var(--muted)">Trésorerie</div>
                </div>
            </div>

            <nav>
                <a href="acceuil.html" class="menu-item"><i class="fas fa-home"></i> Tableau de Bord</a>
                <a href="pos.html" class="menu-item"><i class="fas fa-cash-register"></i> Vente / Caisse</a>
                <a href="stock.html" class="menu-item"><i class="fas fa-box"></i> Gestion Stock</a>
                <a href="tresoreri.html" class="menu-item active"><i class="fas fa-wallet"></i> Trésorerie</a>
                <a href="users.html" class="menu-item"><i class="fas fa-users"></i> Utilisateurs</a>
            </nav>

            <div class="small">© <span id="year"></span> SuperMarket Pro</div>
        </aside>

        <main class="main" role="main">
            <div class="topbar">
                <h1><i class="fas fa-wallet"></i> Gestion de la Trésorerie</h1>
                <div class="controls">
                    <button class="btn" id="btn-add-purchase"><i class="fas fa-plus"></i> Achat</button>
                    <button class="btn" id="btn-add-expense"><i class="fas fa-plus"></i> Dépense</button>
                    <button class="btn secondary" id="btn-export"><i class="fas fa-file-export"></i> Export</button>
                </div>
            </div>

            <!-- STATS -->
            <div class="stats">
                <div class="stat-card success">
                    <h4>Revenus Totaux</h4>
                    <div class="value" id="stat-revenue">0 €</div>
                    <div class="small-muted">Ce mois</div>
                </div>
                <div class="stat-card danger">
                    <h4>Dépenses Totales</h4>
                    <div class="value" id="stat-expenses">0 €</div>
                    <div class="small-muted">Ce mois</div>
                </div>
                <div class="stat-card">
                    <h4>Bénéfice Net</h4>
                    <div class="value" id="stat-profit">0 €</div>
                    <div class="small-muted">Ce mois</div>
                </div>
                <div class="stat-card warning">
                    <h4>Factures En Attente</h4>
                    <div class="value" id="stat-pending">0</div>
                    <div class="small-muted">À payer</div>
                </div>
            </div>

            <!-- TABS -->
            <div class="tabs" role="tablist">
                <button class="tab active" data-tab="dashboard"><i class="fas fa-chart-line"></i> Tableau de Bord</button>
                <button class="tab" data-tab="purchases"><i class="fas fa-shopping-cart"></i> Achats</button>
                <button class="tab" data-tab="expenses"><i class="fas fa-money-bill"></i> Dépenses</button>
                <button class="tab" data-tab="invoices"><i class="fas fa-file-invoice"></i> Factures</button>
                <button class="tab" data-tab="reports"><i class="fas fa-chart-bar"></i> Rapports</button>
            </div>

            <!-- TAB: DASHBOARD -->
            <section id="tab-dashboard" class="panel" role="tabpanel" aria-labelledby="tab-dashboard">
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
                    <div>
                        <h3>Revenu vs Dépenses</h3>
                        <div class="chart-container">
                            <canvas id="chartRevenue"></canvas>
                        </div>
                    </div>
                    <div>
                        <h3>Catégories de Dépenses</h3>
                        <div class="chart-container">
                            <canvas id="chartExpenses"></canvas>
                        </div>
                    </div>
                </div>

                <h3 style="margin-top:20px">Flux de Trésorerie (30 jours)</h3>
                <div class="chart-container">
                    <canvas id="chartCashFlow"></canvas>
                </div>

                <h3 style="margin-top:20px">Transactions Récentes</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Montant</th>
                            <th>Statut</th>
                        </tr>
                    </thead>
                    <tbody id="recentTransactionsTable"></tbody>
                </table>
            </section>

            <!-- TAB: PURCHASES -->
            <section id="tab-purchases" class="panel" role="tabpanel" aria-labelledby="tab-purchases" style="display:none">
                <h3>Enregistrer un Achat</h3>
                
                <div class="form-row">
                    <div>
                        <div class="form-label">Fournisseur *</div>
                        <input id="p-supplier" class="input" type="text" placeholder="Nom du fournisseur" />
                    </div>
                    <div>
                        <div class="form-label">Catégorie *</div>
                        <select id="p-category" class="input">
                            <option value="">-- Sélectionner --</option>
                            <option value="alimentaire">Alimentaire</option>
                            <option value="hygiene">Hygiène & Nettoyage</option>
                            <option value="boisson">Boissons</option>
                            <option value="autre">Autre</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div>
                        <div class="form-label">Numéro Facture</div>
                        <input id="p-invoice-no" class="input" placeholder="INV-2024-001" />
                    </div>
                    <div>
                        <div class="form-label">Date d'Achat *</div>
                        <input id="p-date" class="input" type="date" />
                    </div>
                </div>

                <div class="form-row">
                    <div>
                        <div class="form-label">Montant *</div>
                        <input id="p-amount" class="input" type="number" min="0" step="0.01" placeholder="0.00" />
                    </div>
                    <div>
                        <div class="form-label">Devise *</div>
                        <select id="p-devise" class="input">
                            <option value="CDF">FC (Franc Congolais)</option>
                            <option value="USD">USD (Dollar)</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div>
                        <div class="form-label">Statut Paiement</div>
                        <select id="p-payment-status" class="input">
                            <option value="pending">En attente</option>
                            <option value="paid">Payé</option>
                            <option value="partially">Partiellement payé</option>
                        </select>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-label">Notes</div>
                    <textarea id="p-notes" class="input" style="min-height:80px" placeholder="Notes supplémentaires..."></textarea>
                </div>

                <button class="btn success" id="p-save"><i class="fas fa-save"></i> Enregistrer l'Achat</button>

                <hr style="margin:30px 0">

                <h3>Historique des Achats</h3>
                <div class="filters">
                    <input id="search-purchases" class="input" type="search" placeholder="Rechercher..." />
                    <select id="filter-supplier" class="input" style="width:140px">
                        <option value="">Tous les fournisseurs</option>
                    </select>
                    <select id="filter-purchase-status" class="input" style="width:140px">
                        <option value="">Tous les statuts</option>
                        <option value="pending">En attente</option>
                        <option value="paid">Payé</option>
                    </select>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Fournisseur</th>
                            <th>Catégorie</th>
                            <th>N° Facture</th>
                            <th>Montant</th>
                            <th>Statut</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody id="purchasesTable"></tbody>
                </table>
            </section>

            <!-- TAB: EXPENSES -->
            <section id="tab-expenses" class="panel" role="tabpanel" aria-labelledby="tab-expenses" style="display:none">
                <h3>Enregistrer une Dépense</h3>

                <div class="form-row">
                    <div>
                        <div class="form-label">Catégorie *</div>
                        <select id="e-category" class="input">
                            <option value="">-- Sélectionner --</option>
                            <option value="loyer">Loyer</option>
                            <option value="salaires">Salaires</option>
                            <option value="utilities">Électricité/Eau</option>
                            <option value="internet">Internet/Téléphone</option>
                            <option value="maintenance">Maintenance</option>
                            <option value="assurance">Assurance</option>
                            <option value="fournitures">Fournitures Bureau</option>
                            <option value="marketing">Marketing</option>
                            <option value="autre">Autre</option>
                        </select>
                    </div>
                    <div>
                        <div class="form-label">Date *</div>
                        <input id="e-date" class="input" type="date" />
                    </div>
                </div>

                <div class="form-row">
                    <div>
                        <div class="form-label">Montant *</div>
                        <input id="e-amount" class="input" type="number" min="0" step="0.01" placeholder="0.00" />
                    </div>
                    <div>
                        <div class="form-label">Devise *</div>
                        <select id="e-devise" class="input">
                            <option value="CDF">FC (Franc Congolais)</option>
                            <option value="USD">USD (Dollar)</option>
                        </select>
                    </div>
                    <div>
                        <div class="form-label">Mode de Paiement</div>
                        <select id="e-payment-method" class="input">
                            <option value="cash">Espèces</option>
                            <option value="bank">Virement Bancaire</option>
                            <option value="check">Chèque</option>
                            <option value="card">Carte Bancaire</option>
                        </select>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-label">Description</div>
                    <textarea id="e-description" class="input" style="min-height:80px" placeholder="Description de la dépense..."></textarea>
                </div>

                <button class="btn success" id="e-save"><i class="fas fa-save"></i> Enregistrer la Dépense</button>

                <hr style="margin:30px 0">

                <h3>Dépenses du Mois</h3>
                <div class="filters">
                    <input id="search-expenses" class="input" type="search" placeholder="Rechercher..." />
                    <select id="filter-expense-category" class="input" style="width:140px">
                        <option value="">Toutes les catégories</option>
                        <option value="loyer">Loyer</option>
                        <option value="salaires">Salaires</option>
                        <option value="utilities">Utilities</option>
                    </select>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Catégorie</th>
                            <th>Description</th>
                            <th>Montant</th>
                            <th>Mode Paiement</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="expensesTable"></tbody>
                </table>
            </section>

            <!-- TAB: INVOICES -->
            <section id="tab-invoices" class="panel" role="tabpanel" aria-labelledby="tab-invoices" style="display:none">
                <h3>Factures à Payer</h3>

                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Fournisseur</th>
                            <th>Facture #</th>
                            <th>Montant</th>
                            <th>Échéance</th>
                            <th>Statut</th>
                            <th>Retard</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="invoicesTable"></tbody>
                </table>
            </section>

            <!-- TAB: REPORTS -->
            <section id="tab-reports" class="panel" role="tabpanel" aria-labelledby="tab-reports" style="display:none">
                <div class="filters">
                    <input id="report-date-from" type="date" class="input" />
                    <input id="report-date-to" type="date" class="input" />
                    <button class="btn" id="btn-generate-report"><i class="fas fa-file-pdf"></i> Générer Rapport</button>
                </div>

                <h3 style="margin-top:20px">Résumé Financier</h3>
                <div class="stats">
                    <div class="stat-card">
                        <h4>Revenus</h4>
                        <div class="value" id="report-revenue">0 €</div>
                    </div>
                    <div class="stat-card">
                        <h4>Achats</h4>
                        <div class="value" id="report-purchases">0 €</div>
                    </div>
                    <div class="stat-card">
                        <h4>Dépenses</h4>
                        <div class="value" id="report-expenses">0 €</div>
                    </div>
                    <div class="stat-card">
                        <h4>Résultat</h4>
                        <div class="value" id="report-result">0 €</div>
                    </div>
                </div>

                <h3 style="margin-top:20px">Détail par Catégorie</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Catégorie</th>
                            <th>Montant</th>
                            <th>% du Total</th>
                        </tr>
                    </thead>
                    <tbody id="reportTable"></tbody>
                </table>
            </section>
        </main>
    </div>

    <!-- MODAL: Ajouter Achat -->
    <div class="modal" id="modalPurchase">
        <div class="modal-box">
            <div class="modal-header">
                <h3>Ajouter un Achat</h3>
                <button class="modal-close" data-close="modalPurchase">&times;</button>
            </div>
            <div style="padding:14px">
                <p>Veuillez remplir le formulaire dans l'onglet "Achats"</p>
            </div>
        </div>
    </div>

    <!-- MODAL: Ajouter Dépense -->
    <div class="modal" id="modalExpense">
        <div class="modal-box">
            <div class="modal-header">
                <h3>Ajouter une Dépense</h3>
                <button class="modal-close" data-close="modalExpense">&times;</button>
            </div>
            <div style="padding:14px">
                <p>Veuillez remplir le formulaire dans l'onglet "Dépenses"</p>
            </div>
        </div>
    </div>

    <script src="assets/js/script_treasury.js"></script>
</body>
</html>